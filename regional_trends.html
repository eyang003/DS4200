<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Regional Trends</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
    <!-- header -->
    <header>
        <h1>How Climate Change Impacts Agriculture</h1>
        <p>Exploring global and regional trends, and the effectiveness of adaptation strategies.</p>
    </header>

    <!-- navigation -->
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="the_problem.html">The Problem</a></li>
            <li><a href="regional_trends.html">Regional Analysis</a></li>
            <li><a href="adaptation_strategies.html">Adaptation Strategies</a></li>
            <li><a href="https://github.com/eyang003/DS4200" target="_blank" class="github-btn">Visit our GitHub Repo!</a></li>
        </ul>
    </nav>

    <main>
        <section>
            <h2>Country Crop Yields Over Time</h2>
            <p>To help us identify possible climate change factors affecting crop yields, we started by identifying countries that have seen the most/least
                improvement in crop yields from 1990 - 2024. The graph below calculates the average crop yield for a country in 1990 compared to 2024 and we identified
                the top 3 countries being Brazil, China, and Russia whereas the bottom 3 were Argentina, Russia, and the USA.</p>
            <img src="plots/country_crop_yields.png" alt="Countries with most and least increase in crop yields">
        </section>

        <section>
            <h2>Regional Analysis: CO2 Emissions vs Crop Yields</h2>
            <p>This section visualizes the relationship between CO2 emissions and crop yields for Nigeria and Russia.</p>
            <!-- Create a div where the D3 plot will be rendered -->
            <div id="scatterPlot"></div>
        </section>

        <section>
            <h2>[PLACEHOLDER SECTION]</h2>
            <p>[SECTION PLACEHOLDER]</p>
            <img src="plots/Regional_Weather_Trends.png" alt="Regional Weather Trends">
        </section>

        <section>
            <h2>[PLACEHOLDER SECTION]</h2>
            <p>[SECTION PLACEHOLDER]</p>
            <img src="plots/Pesticide_vs_Fertilizer_Yields.png" alt="Pesticide vs Fertilizer Yields">
        </section>
    </main>

    <footer>
        <button onclick="window.location.href='index.html'">Back to Home</button>
    </footer>
    <script>
        // D3.js code to create the plot
        d3.json("nigeria_russia_data.json").then(function(data) {
            // Filter data for Nigeria and Russia
            const nigeria_russia_data = data.filter(d => d.Country === "Nigeria" || d.Country === "Russia");

            const width = 800, height = 400;

            // Create the SVG container for the plot
            const svg = d3.select("#scatterPlot")
                .append("svg")
                .attr("width", width)
                .attr("height", height);

            // Scales for the axes
            const xScale = d3.scaleLinear()
                .domain([0, d3.max(nigeria_russia_data, d => +d.CO2_Emissions_MT)])
                .range([50, width - 50]);

            const yScale = d3.scaleLinear()
                .domain([0, d3.max(nigeria_russia_data, d => +d.Crop_Yield_MT_per_HA)])
                .range([height - 50, 50]);

            const colorScale = d3.scaleOrdinal()
                .domain(["Nigeria", "Russia"])
                .range(["green", "orange"]);

            // Add x-axis
            svg.append("g")
                .attr("transform", `translate(0,${height - 50})`)
                .call(d3.axisBottom(xScale));

            // Add y-axis
            svg.append("g")
                .attr("transform", "translate(50, 0)")
                .call(d3.axisLeft(yScale));

            // Scatter plot: CO2 Emissions vs Crop Yield
            svg.selectAll("circle")
                .data(nigeria_russia_data)
                .enter()
                .append("circle")
                .attr("cx", d => xScale(+d.CO2_Emissions_MT))
                .attr("cy", d => yScale(+d.Crop_Yield_MT_per_HA))
                .attr("r", 8)
                .attr("fill", d => colorScale(d.Country))
                .on("mouseover", (event, d) => {
                    // Show tooltip on hover
                    d3.select(".tooltip")
                        .style("opacity", 1)
                        .html(`Country: ${d.Country}<br>CO2 Emissions: ${d.CO2_Emissions_MT}<br>Crop Yield: ${d.Crop_Yield_MT_per_HA}`)
                        .style("left", `${event.pageX + 5}px`)
                        .style("top", `${event.pageY - 28}px`);
                })
                .on("mouseout", () => {
                    // Hide tooltip when mouse leaves
                    d3.select(".tooltip")
                        .style("opacity", 0);
                });

            // Tooltip (you can style it as needed)
            d3.select("body").append("div")
                .attr("class", "tooltip")
                .style("opacity", 0);
        }).catch(function(error) {
            console.error('Error loading the JSON:', error);
        });
    </script>
</body>
</html>
